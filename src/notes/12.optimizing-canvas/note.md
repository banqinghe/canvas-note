# canvas 的优化

- **在离屏canvas上预渲染相似的图形或重复的对象**（比如图像固定的背景）
  如果发现自己在每个动画帧上重复了一些相同的绘制操作，请考虑将其分流到屏幕外的画布上。 然后，您可以根据需要频繁地将屏幕外图像渲染到主画布上，而不必首先重复生成该图像的步骤。
- **避免浮点数的坐标点，用整数取而代之**
  浏览器为了达到抗锯齿的效果会做额外的运算。
- **不要在用drawImage时缩放图像**
  在离屏canvas中缓存图片的不同尺寸，而不要用drawImage()去缩放它们。
- **使用多层画布去画一个复杂的场景**
  假设您有一个游戏，其UI位于顶部，中间是游戏性动作，底部是静态背景。 在这种情况下，您可以将游戏分成三个<canvas>层。 UI将仅在用户输入时发生变化，游戏层随每个新框架发生变化，并且背景通常保持不变。
- **用CSS设置大的背景图**
- **用CSS transforms特性缩放画布**
  最好的情况是不直接缩放画布，或者具有较小的画布并按比例放大，而不是较大的画布并按比例缩小。
- **关闭透明度**

  ```javascript
  // 这个选项可以帮助浏览器进行内部优化
  canvas.getContext('2d', { alpha: false });
  ```

- **将画布的函数调用集合到一起（例如，画一条折线，而不要画多条分开的直线）**
- **避免不必要的画布状态改变**
- **渲染画布中的不同点，而非整个新状态**
- **尽可能避免 shadowBlur特性** （和 box-shadow 有点像）
- **尽可能避免text rendering**
- **尝试不同的方法来清除画布(clearRect() vs. fillRect() vs. 调整canvas大小)**
- **有动画，请使用window.requestAnimationFrame() 而非window.setInterval()**
- **谨慎使用大型物理库**
